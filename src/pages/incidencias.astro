---
import Layout from "../layouts/Layout.astro";
import { IncidenciasManager } from "@/components/incidencias";
import { getSession } from 'auth-astro/server';

const session = await getSession(Astro.request);
const { isAdmin, user } = Astro.locals;

// Obtener el userName del usuario actual
const currentUserName = user?.name || session?.user?.name || '';
---

<Layout title="Incidencias | PPAM Malabo">
  <section class="max-w-4xl mx-auto mt-6">
    <IncidenciasManager
      client:only="react"
      isAdmin={isAdmin}
      currentUserName={currentUserName}
    />
  </section>
</Layout>
